<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="src/favicon.png">
  <title>PianoWizard</title>
  <link rel="stylesheet" href="/style.css">
  <script src="https://cdn.jsdelivr.net/npm/webmidi@latest/dist/iife/webmidi.iife.js"></script>
</head>
<body class="bg-[#536bc8] !bg-[url('/src/peggle.png')] !bg-cover !bg-no-repeat !bg-center overflow-hidden;!image-rendering: pixelated;">
  <div id="app">

    <div id="lobby" class="text-black! flex flex-col gap-2 justify-center items-center h-screen">
      <img src="src/logo.png" width="380px" class="drop-shadow-md"/>
      <button id="create-btn" class="p-8 text-white! !from-[#ac3232] !to-[#78371c] border-b-[#78371c]! border-[#ac3232]! border-2! bg-linear-0 rounded-md font-[LilitaOne] hover:brightness-75  hover:duration-0  duration-500">CREATE LOBBY</button>
      <div id="share-link" class="text-black! bg-white/50 rounded-md overflow-hidden duration-500 w-108" style="height:0px;">
        <p>Share this link with your friend:</p>
        <div class="flex justify-center items-center">
          <input type="text" class="duration-500 w-96 translate-x-5 hover:bg-white/80! rounded-md! border! border-gray-500!" id="room-link" readonly>
          <button id="copy-btn" class="p-0! flex justify-center items-center -translate-x-5 duration-500 hover:bg-white/80! rounded-md! border! border-gray-500! h-8! w-8!">
            <object data="src/iconmonstr-copy-clipboard-lined.svg" class="pointer-events-none" width="15px" height="15px"></object>
          </button>
        </div>
      </div>
      <button id="join-btn" class="p-8 text-white from-[#ac3232] to-[#78371c] border-b-[#78371c]! border-[#ac3232]! border-2! bg-linear-0 rounded-md font-[LilitaOne] hover:brightness-75 hover:duration-0 duration-500">JOIN LOBBY</button>
      <p class="text-[#342b1f]! bg-white/50 p-4 rounded-sm text-center">Piano Wizard is an online tool to play HORSE against fellow pianists!<br/>Written by wizards for wizards.</p>

    </div>

    <!-- Join Room Modal -->
    <div id="join-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50" style="display: none;">
      <div class="bg-white rounded-lg p-8 w-96 shadow-lg">
        <h2 class="text-2xl font-bold mb-4 text-black">Join Game</h2>
        <p class="text-black mb-4">Enter the 8-digit room code:</p>
        <input
          type="text"
          id="join-code-input"
          maxlength="8"
          placeholder="XXXXXXXX"
          class="w-full px-4 py-2 border border-gray-300 rounded-md mb-4 text-black text-center text-xl tracking-widest"
        />
        <div class="flex gap-2 justify-end">
          <button id="join-cancel-btn" class="px-6 py-2 bg-gray-400 text-white rounded-md hover:brightness-90">Cancel</button>
          <button id="join-confirm-btn" class="px-6 py-2 bg-blue-500 text-white rounded-md hover:brightness-90">Join</button>
        </div>
      </div>
      </div>

      <div
        id="game-container"
        class="bg-[#536bc8] bg-[url('/src/peggle.png')] bg-cover bg-no-repeat bg-center overflow-hidden"
        style="display: none; image-rendering: pixelated"
      >
        <!-- Forfeit Button - Top Left -->
        <button
          id="forfeit-btn"
          class="bg-[url('/src/forfeit.png')] absolute top-5 left-5 w-[270px] h-[66px] hover:brightness-75 cursor-pointer bg-cover bg-center bg-no-repeat border-none"
        ></button>

        <!-- Staff Container - Top Right, independent positioning (removeable) -->
        <div
          id="staff-wrapper"
          class="bg-cover! bg-no-repeat! bg-center! absolute top-5 right-5 z-50 bg-[url('../media/chalkboard.png')]"
        >
          <div id="staff-container">
            <h3>Staff Notation</h3>
            <div id="staff"></div>
          </div>
        </div>

        <!-- Game Status & Controls - Top Left (below forfeit) -->
        <div id="game" class="absolute top-24 left-5 z-40">
          <div id="status">
            <div id="turn-info"></div>
            <div id="timer" style="display: none">
              Time: <span id="time-left">50</span>s
            </div>
          </div>

          <div id="controls">
            <button id="done-btn" style="display: none">Done</button>
            <button id="listen-btn" style="display: none">
              Listen to Melody
            </button>
            <button id="submit-btn" style="display: none">
              Submit Attempt
            </button>
          </div>

          <div id="message"></div>
        </div>

        <!-- Wizard Sprites - Center, slightly shrunk and higher up -->
        <div
          id="wizard-sprites"
          class="flex flex-col items-center justify-center absolute top-1/3 left-1/2 -translate-x-1/2 -translate-y-1/3 scale-65"
        >
          <div
            class="bg-[url('/src/wizard.png')] bg-cover bg-center bg-no-repeat w-[397px] h-[607px] z-10"
          ></div>
          <div
            class="bg-[url('/src/keyboard.png')] -translate-y-32 bg-cover bg-center bg-no-repeat w-[942px] h-[529px] z-20"
          ></div>
          <div
            id="hand-left"
            style="animation-duration: 0.5s; opacity: 0"
            class="hand-bounce bg-[url('/src/hand.png')] absolute -translate-y-100 -translate-x-0 bg-cover bg-center bg-no-repeat w-[116px] h-[166px] z-30 transition-opacity duration-300"
          ></div>
          <div
            id="hand-right"
            style="animation-duration: 1s; opacity: 0"
            class="hand-bounce bg-[url('/src/hand.png')] scale-x-[-1]! absolute -translate-y-100 translate-x-0 bg-cover bg-center bg-no-repeat w-[116px] h-[166px] z-30 transition-opacity duration-300"
          ></div>
        </div>

        <!-- You (Player) Letters - Bottom Left -->
        <div
          class="bg-white/50 p-4 rounded-md flex flex-col items-center justify-center absolute bottom-32 left-10 gap-1 z-50 !scale-x-75 !scale-y-75 origin-bottom-left!"
        >
          <div
            class="bg-[url('/src/menu/you.png')] bg-cover bg-center bg-no-repeat w-[210px] h-[142px]"
          ></div>
          <div
            id="my-letters-container"
            class="flex items-center justify-center gap-1 drop-shadow-lg drop-shadow-black"
          >
            <div
              data-letter="m"
              class="bg-[url('/src/menu/m_blank.png')] bg-cover bg-center bg-no-repeat w-[108px] h-[93px]"
            ></div>
            <div
              data-letter="a"
              class="bg-[url('/src/menu/a_blank.png')] bg-cover bg-center bg-no-repeat w-[74px] h-[92px]"
            ></div>
            <div
              data-letter="g"
              class="bg-[url('/src/menu/g_blank.png')] bg-cover bg-center bg-no-repeat w-[74px] h-[96px]"
            ></div>
            <div
              data-letter="i"
              class="bg-[url('/src/menu/i_blank.png')] bg-cover bg-center bg-no-repeat w-[35px] h-[98px]"
            ></div>
            <div
              data-letter="c"
              class="bg-[url('/src/menu/c_blank.png')] bg-cover bg-center bg-no-repeat w-[78px] h-[102px]"
            ></div>
          </div>
        </div>

        <!-- Opponent Letters - Bottom Right -->
        <div
          class="bg-white/50 p-4 rounded-md flex flex-col items-center justify-center absolute bottom-32 right-10 gap-1 z-50 !scale-x-75 !scale-y-75 origin-bottom-right!"
        >
          <div
            class="bg-[url('/src/menu/opp.png')] bg-cover bg-center bg-no-repeat w-[240px] h-[158px]"
          ></div>
          <div
            id="opp-letters-container"
            class="flex items-center justify-center gap-1 drop-shadow-lg drop-shadow-black"
          >
            <div
              data-letter="m"
              class="bg-[url('/src/menu/m_blank.png')] bg-cover bg-center bg-no-repeat w-[108px] h-[93px]"
            ></div>
            <div
              data-letter="a"
              class="bg-[url('/src/menu/a_blank.png')] bg-cover bg-center bg-no-repeat w-[74px] h-[92px]"
            ></div>
            <div
              data-letter="g"
              class="bg-[url('/src/menu/g_blank.png')] bg-cover bg-center bg-no-repeat w-[74px] h-[96px]"
            ></div>
            <div
              data-letter="i"
              class="bg-[url('/src/menu/i_blank.png')] bg-cover bg-center bg-no-repeat w-[35px] h-[98px]"
            ></div>
            <div
              data-letter="c"
              class="bg-[url('/src/menu/c_blank.png')] bg-cover bg-center bg-no-repeat w-[78px] h-[102px]"
            ></div>
          </div>
        </div>

        <!-- Piano - Fixed at Bottom (PianoWizards layout C3-C5) -->
        <div id="piano">
          <div id="black-keys">
            <button data-note="C#3">W</button>
            <button data-note="D#3">E</button>
            <span class="spacer"></span>
            <button data-note="F#3">T</button>
            <button data-note="G#3">Y</button>
            <button data-note="A#3">U</button>
            <span class="spacer"></span>
            <button data-note="C#4">O</button>
            <button data-note="D#4">P</button>
            <span class="spacer"></span>
            <button data-note="F#4">[</button>
            <button data-note="G#4">]</button>
            <button data-note="A#4">C</button>
          </div>
          <div id="white-keys">
            <button data-note="C3">A</button>
            <button data-note="D3">S</button>
            <button data-note="E3">D</button>
            <button data-note="F3">F</button>
            <button data-note="G3">G</button>
            <button data-note="A3">H</button>
            <button data-note="B3">J</button>
            <button data-note="C4">K</button>
            <button data-note="D4">L</button>
            <button data-note="E4">;</button>
            <button data-note="F4">'</button>
            <button data-note="G4">Z</button>
            <button data-note="A4">X</button>
            <button data-note="B4">V</button>
            <button data-note="C5">B</button>
          </div>
        </div>
      </div>

      <div id="game-over"  style="  display: none">
        <h2 class="text-black!" id="result-text"></h2>
        <button id="new-game-btn">New Game</button>
      </div>
    </div>

    <script type="module" src="/main.js"></script>
  </body>
</html>

